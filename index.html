<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRM: Operadores de Apuestas en México</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9; /* slate-100 */
        }
        .progress-bar-container {
            background-color: #e2e8f0; /* slate-200 */
            border-radius: 9999px;
            overflow: hidden;
        }
        .progress-bar {
            background-color: #2563eb; /* blue-600 */
            height: 100%;
            transition: width 0.5s ease-in-out;
        }
        .contact-card {
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05), 0 2px 4px -2px rgba(0,0,0,0.05);
            transition: all 0.3s ease-in-out;
            border-left: 5px solid #64748b; /* slate-500 for 'Pendiente' */
            display: flex;
            flex-direction: column;
        }
        .contact-card .card-content {
            flex-grow: 1;
        }
        .contact-card.contactado {
            border-left-color: #16a34a; /* green-600 */
            background-color: #f0fdf4; /* green-50 */
        }
        .custom-checkbox {
            appearance: none;
            background-color: #fff;
            margin: 0;
            font: inherit;
            color: currentColor;
            width: 1.15em;
            height: 1.15em;
            border: 0.15em solid currentColor;
            border-radius: 0.25em;
            transform: translateY(-0.075em);
            display: grid;
            place-content: center;
            cursor: pointer;
        }
        .custom-checkbox::before {
            content: "";
            width: 0.65em;
            height: 0.65em;
            transform: scale(0);
            transition: 120ms transform ease-in-out;
            box-shadow: inset 1em 1em #2563eb;
            transform-origin: bottom left;
            clip-path: polygon(14% 44%, 0 65%, 50% 100%, 100% 16%, 80% 0%, 43% 62%);
        }
        .custom-checkbox:checked::before {
            transform: scale(1);
        }
    </style>
</head>
<body class="antialiased text-slate-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-extrabold text-slate-900 tracking-tight">Dashboard de Contactos: Industria del Juego en México</h1>
            <p class="mt-2 text-lg text-slate-600 max-w-3xl mx-auto">Una herramienta interactiva para gestionar y rastrear tu comunicación con operadores.</p>
        </header>

        <!-- Stats and Progress Section -->
        <section class="mb-8 p-6 bg-white rounded-xl shadow-lg">
            <h2 class="text-2xl font-bold mb-4 text-slate-800">Resumen de Progreso</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                    <div class="text-4xl font-extrabold text-blue-600" id="total-contacts">0</div>
                    <div class="text-sm font-medium text-slate-500">Contactos Totales</div>
                </div>
                <div>
                    <div class="text-4xl font-extrabold text-green-600" id="contacted-count">0</div>
                    <div class="text-sm font-medium text-slate-500">Contactados</div>
                </div>
                <div>
                    <div class="text-4xl font-extrabold text-slate-600" id="pending-count">0</div>
                    <div class="text-sm font-medium text-slate-500">Pendientes</div>
                </div>
            </div>
            <div class="mt-6">
                <div class="flex justify-between mb-1">
                    <span class="text-base font-medium text-blue-700">Progreso de Contacto</span>
                    <span class="text-sm font-medium text-blue-700" id="progress-percentage">0%</span>
                </div>
                <div class="progress-bar-container w-full h-4">
                    <div id="progress-bar" class="progress-bar h-4 rounded-full"></div>
                </div>
            </div>
        </section>

        <!-- Filters -->
        <div class="mb-8 p-4 bg-white rounded-xl shadow-md grid grid-cols-1 md:grid-cols-3 gap-4 items-center">
            <div class="flex-grow">
                <label for="filter-type" class="block text-sm font-medium text-slate-700">Filtrar por tipo:</label>
                <select id="filter-type" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-slate-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md">
                    <option value="all">Todos los Tipos</option>
                    <option value="permisionario">Permisionarios</option>
                    <option value="operador-segob">Operadores SEGOB</option>
                    <option value="operador-internacional">Operadores Internacionales</option>
                    <option value="casino-fisico">Casinos Físicos</option>
                </select>
            </div>
            <div class="flex-grow">
                <label for="filter-status" class="block text-sm font-medium text-slate-700">Filtrar por estado:</label>
                <select id="filter-status" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-slate-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md">
                    <option value="all">Todos los Estados</option>
                    <option value="pendiente">Pendiente</option>
                    <option value="contactado">Contactado</option>
                </select>
            </div>
            <div class="flex-grow">
                <label for="filter-location" class="block text-sm font-medium text-slate-700">Filtrar por ubicación:</label>
                <select id="filter-location" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-slate-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md">
                    <option value="all">Todas las Ubicaciones</option>
                </select>
            </div>
        </div>

        <!-- Contact Cards Grid -->
        <main id="contacts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            <!-- JS will inject cards here -->
        </main>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // --- DATA ---
        const allContacts = [
            // Permisionarios from PERMISIONARIOS-hecho.docx
            { id: "perm_0", type: 'permisionario', name: "Espectáculos Deportivos Frontón México S.A. de C.V.", location: "Ciudad de México", email: "contacto@frontonmexico.com.mx", website: "frontonmexico.com.mx", phone: "+52 55 5128 3408" },
            { id: "perm_00", type: 'permisionario', name: "Hipódromo de Agua Caliente S.A. de C.V.", location: "Baja California", email: "contacto@caliente.com.mx", website: "grupocaliente.com.mx", phone: "(664) 647 4770" },
            { id: "perm_1", type: 'permisionario', name: "PETOLOF S.A. de C.V.", location: "Nuevo León", email: "N/A", website: "N/A", phone: "N/A" },
            { id: "perm_2", type: 'permisionario', name: "Cesta-Punta Deportes S.A. de C.V.", location: "Chihuahua", email: "N/A", website: "cestapunta.com", phone: "N/A" },
            { id: "perm_3", type: 'permisionario', name: "Libros Foráneos S.A. de C.V.", location: "Puebla", email: "plazadorada.operaciones@codere.com", website: "codere.mx", phone: "(222) 225 7102" },
            { id: "perm_6", type: 'permisionario', name: "Espectáculos Deportivos de Cancún S.A. de C.V.", location: "Quintana Roo", email: "N/A", website: "N/A", phone: "N/A" },
            { id: "perm_7", type: 'permisionario', name: "Atracciones y Emociones Vallarta S.A. de C.V.", location: "Quintana Roo", email: "litigio@notaria39.com.mx", website: "strendus.com.mx", phone: "(044) 998 301 8041" },
            { id: "perm_11", type: 'permisionario', name: "Operadora Cantabria S.A. de C.V.", location: "Ciudad de México", email: "amatzin58@gmail.com", website: "N/A", phone: "(722) 212 5526" },
            { id: "perm_12", type: 'permisionario', name: "Grupo Océano Haman S.A. de C.V.", location: "Ciudad de México", email: "jose.ortega@caliente.com.mx", website: "calientecasino.com.mx", phone: "(55) 5245 8291" },
            { id: "perm_16", type: 'permisionario', name: "Comercial de Juegos de la Frontera S.A. de C.V.", location: "Estado de México", email: "administracion.metepec@bigbola.com", website: "bigbola.com", phone: "(722) 232 5552" },
            { id: "perm_17", type: 'permisionario', name: "Mio Games S.A. de C.V.", location: "Ciudad de México", email: "rodolfo.hernandez@codere.com", website: "codere.mx", phone: "(55) 5588 0509" },
            { id: "perm_18", type: 'permisionario', name: "Juega y Juega S.A. de C.V.", location: "Tamaulipas", email: "san-dila@gmail.com", website: "juegayjuega.com.mx", phone: "N/A" },
            { id: "perm_21", type: 'permisionario', name: "Apuestas Internacionales S.A. de C.V.", location: "Veracruz", email: "N/A", website: "playcity.com", phone: "N/A" },
            { id: "perm_22", type: 'permisionario', name: "El Palacio de los Números S.A. de C.V.", location: "Ciudad de México", email: "contacto@pdn.com.mx", website: "pdn.com.mx", phone: "(55) 5564 8709" },
            { id: "perm_23", type: 'permisionario', name: "Juegos y Sorteos de Jalisco S.A. de C.V.", location: "Jalisco", email: "N/A", website: "jsjgaming.com.mx", phone: "N/A" },
            
            // Operadores SEGOB
            { id: "op_1xbet", type: 'operador-segob', name: "1xBet", location: "Online", email: "support@1xbet-team.com", website: "1xbet.com.mx", phone: "+52 800 461 0406" },
            { id: "op_bet365", type: 'operador-segob', name: "Bet365", location: "Online", email: "ayuda@bet365.com", website: "bet365.mx", phone: "+52 55 5720 9165" },
            { id: "op_codere", type: 'operador-segob', name: "Codere", location: "Ciudad de México", email: "apuestas@codere.mx", website: "codere.mx", phone: "+52 55 5201 7800" },
            { id: "op_winpot", type: 'operador-segob', name: "Winpot", location: "Online", email: "soporte@winpot.mx", website: "winpot.mx", phone: "N/A" },
            { id: "op_playdoit", type: 'operador-segob', name: "Playdoit", location: "Online", email: "soporte@playdoit.mx", website: "playdoit.mx", phone: "N/A" },
            { id: "op_campobet", type: 'operador-segob', name: "Campobet", location: "Online", email: "support@campobet.com", website: "campobet.com", phone: "N/A" },
            { id: "op_10bet", type: 'operador-segob', name: "10Bet", location: "Online", email: "soporte@10bet.mx", website: "10bet.mx", phone: "+52 55 6943 7023" },
            { id: "op_sportiumbet", type: 'operador-segob', name: "Sportiumbet", location: "Online", email: "contacto@sportiumbet.mx", website: "sportiumbet.mx", phone: "N/A" },
            { id: "op_novibet", type: 'operador-segob', name: "Novibet", location: "Online", email: "support@novibet.com", website: "novibet.mx", phone: "N/A" },
            { id: "op_betsson", type: 'operador-segob', name: "Betsson", location: "Ciudad de México", email: "soporte@betsson.mx", website: "betsson.mx", phone: "N/A" },
            { id: "op_instabet", type: 'operador-segob', name: "Instabet", location: "Online", email: "soporte@instabet.mx", website: "instabet.mx", phone: "N/A" },
            { id: "op_strendus", type: 'operador-segob', name: "Strendus", location: "Online", email: "ayuda@strendus.mx", website: "strendus.mx", phone: "+52 800 123 6789" },
            { id: "op_playcity", type: 'operador-segob', name: "PlayCity", location: "Múltiples", email: "contacto@playcity.com.mx", website: "playcity.com", phone: "+52 55 5678 3700" },
            { id: "op_mexplay", type: 'operador-segob', name: "Mexplay", location: "Online", email: "soporte@mexplay.com.mx", website: "mexplay.com.mx", phone: "N/A" },
            { id: "op_betway", type: 'operador-segob', name: "Betway", location: "Ciudad de México", email: "contacto@betway.mx", website: "betway.mx", phone: "800 9 530 172" },
            { id: "op_diamante", type: 'operador-segob', name: "Diamante Casino", location: "Estado de México", email: "produccion@diamantecasino.com.mx", website: "diamantecasino.com.mx", phone: "+52 55 2661 3265" },
            { id: "op_winner", type: 'operador-segob', name: "Winner.mx", location: "Online", email: "soporte@winner.mx", website: "winner.mx", phone: "N/A" },
            { id: "op_mostbet", type: 'operador-segob', name: "MostBet", location: "Online", email: "support@mostbet.com", website: "mostbet.com.mx", phone: "N/A" },
            { id: "op_betmexico", type: 'operador-segob', name: "BetMexico", location: "Nuevo León", email: "contacto@betmexico.mx", website: "betmexico.mx", phone: "+52 81 1982 3524" },
            { id: "op_888", type: 'operador-segob', name: "888sport", location: "Online", email: "support@888.com", website: "888sport.com.mx", phone: "+44 1273 750 070" },
            { id: "op_betmaster", type: 'operador-segob', name: "Betmaster", location: "Online", email: "soporte@betmaster.com.mx", website: "betmaster.com.mx", phone: "N/A" },
            { id: "op_bbrbet", type: 'operador-segob', name: "BBRBET Casino", location: "Online", email: "support@brbbet.com", website: "brbbet.com.mx", phone: "+52 55 8765 4321" },
            { id: "op_playuzu", type